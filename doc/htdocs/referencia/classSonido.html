<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>libWiiEsp: Referencia de la Clase Sonido</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generado por Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Buscar');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libWiiEsp&#160;<span id="projectnumber">0.9.2</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Página&#160;principal</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Clases</span></a></li>
      <li><a href="files.html"><span>Archivos</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Buscar" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Lista&#160;de&#160;clases</span></a></li>
      <li><a href="classes.html"><span>Índice&#160;de&#160;clases</span></a></li>
      <li><a href="inherits.html"><span>Jerarquía&#160;de&#160;la&#160;clase</span></a></li>
      <li><a href="functions.html"><span>Miembros&#160;de&#160;las&#160;clases</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Métodos públicos</a> &#124;
<a href="#pub-static-methods">Métodos públicos estáticos</a> &#124;
<a href="#pro-methods">Métodos protegidos</a>  </div>
  <div class="headertitle">
<h1>Referencia de la Clase Sonido</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="Sonido" -->
<p>Clase que representa un efecto de sonido que se puede reproducir.  
<a href="#_details">Más...</a></p>

<p><code>#include &lt;<a class="el" href="sonido_8h_source.html">sonido.h</a>&gt;</code></p>

<p><a href="classSonido-members.html">Lista de todos los miembros.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Métodos públicos</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSonido.html#a27ca939578ce997d3e1b618389663c74">Sonido</a> (const std::string &amp;ruta, u8 volder=255, u8 volizq=255)  throw (ArchivoEx, TarjetaEx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSonido.html#ab9cf74dc8ab701bde8457717814e9f7f">~Sonido</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSonido.html#a43de62e384345dcdcd3e7c989806cccf">play</a> (void) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSonido.html#a49658fea59993ab7b5e474b5cb74ced1">setVolumenIzquierdo</a> (u8 volumen)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSonido.html#a9a9f095bac28bf072492e8706c290746">setVolumenDerecho</a> (u8 volumen)</td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Métodos públicos estáticos</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSonido.html#a2326861663e09bde40ce0fc2be5f08db">inicializar</a> (void)</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Métodos protegidos</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSonido.html#aedd111f5a9ec76de8984f8f5a2191894">Sonido</a> (const <a class="el" href="classSonido.html">Sonido</a> &amp;m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSonido.html">Sonido</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSonido.html#aa0d702b357aaebab2ab20be4cbb2602f">operator=</a> (const <a class="el" href="classSonido.html">Sonido</a> &amp;m)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Descripción detallada</h2>
<div class="textblock"><p>Clase que representa un efecto de sonido que se puede reproducir. </p>
<dl class="author"><dt><b>Autor:</b></dt><dd>Ezequiel Vázquez de la Calle </dd></dl>
<dl class="version"><dt><b>Versión:</b></dt><dd>0.9.2</dd></dl>
<p>Al igual que el resto de clases que representa a un recurso multimedia, la clase <a class="el" href="classSonido.html" title="Clase que representa un efecto de sonido que se puede reproducir.">Sonido</a> proporciona abstracción sobre las funciones y estructuras de datos necesarias para reproducir efectos de sonido en la Wii. La base sobre la que se trabaja es la libASND, que forma parte de la libogc.</p>
<p>Cada instancia de la clase representa un efecto de sonido concreto, que puede ser reproducido en cualquier momento de la ejecución. Se crea a partir de un archivo de sonido, con un formato bastante concreto, pero que es muy fácil de obtener a partir de prácticamente cualquier archivo de audio mediante el uso de SoX, una herramienta libre, que consiste en un conversor de formatos de audio muy potente, y que se utiliza en línea de comandos de cualquier sistema UNIX (de hecho, se incluye en los repositorios de Ubuntu).</p>
<p>El mencionado formato al que necesitamos convertir todos nuestros efectos de sonido (que no música, reitero), es PCM crudo (es decir, sólo la información del sonido, sin cabeceras de archivo), con distribución de bytes en big endian, samples de 16 bits con signo, frecuencia de 48000 Hz y 2 canales. Evidentemente, la consola puede reproducir muchos más formatos de sonido (mono y estéreo, samples de 8 y 16 bits, y frecuencias en un rango que va desde 1 Hz hasta los 144000Hz), pero se ha seleccionado éste porque, según la documentación consultada, es el formato nativo con el que trabaja la consola.</p>
<p>Para transformar un sonido input.wav en otro con el formato explicado output.pcm, se utilizaría la siguiente orden en la consola de comandos:</p>
<div class="fragment"><pre class="fragment"> sox input.wav -V3 --encoding <span class="keywordtype">signed</span>-integer --type raw --bits 16 --endian big --channels 2 --rate 48000 output.pcm
</pre></div><p>Una vez finalizada la conversión, basta con copiar el archivo output.pcm a la tarjeta SD, y trabajar con la clase <a class="el" href="classSonido.html" title="Clase que representa un efecto de sonido que se puede reproducir.">Sonido</a> para tener el efecto disponible para su reproducción.</p>
<p>Existe un detalle importante a tener en cuenta, y es relativo al sistema de sonido de la Nintendo Wii. La libASND puede mezclar 16 voces de sonido, una de las cuales está reservada para la pista de música. Esto es así porque la cantidad de instrucciones a procesar para mezclar 16 voces con la diversidad de formatos expuesta antes es muy elevada.</p>
<p>En la libASND, una voz no es más que un flujo de datos, cuyo estado se comprueba con una interrupción de audio que es llamada cada 21,333 ms. Si hubiera entrada en una voz, ésta pasaría directamente al DSP, que es un procesador cuya única tarea es la de procesar los efectos de sonido. Con esto se consigue descongestionar al procesador principal, y obtener una mayor potencia a la hora de trabajar con el audio.</p>
<p>Cada vez que un sonido es reproducido, se busca una voz desocupada (que no esté reproduciendo nada en ese momento), y se envía allí la secuencia de datos que componen el sonido. Evidentemente, esto quiere decir que sólo se pueden reproducir, en un mismo momento, 15 efectos de sonido y una pista de música, cantidad más que suficiente para el desarrollo de juegos en dos dimensiones. Si en algún momento, se intentaran reproducir más sonidos de los que se permiten, no ocurriría ningún error, porque existe un mecanismo que evita que haya conflictos: si no hay ninguna voz libre, el sonido no se intenta reproducir.</p>
<p>Funcionamiento interno de la clase <a class="el" href="classSonido.html" title="Clase que representa un efecto de sonido que se puede reproducir.">Sonido</a></p>
<p>Esta clase es muy sencilla en su implementación, ya que únicamente carga desde un archivo alojado en la tarjeta SD un flujo de bytes, que se almacena tal cual en memoria, y que se envía a la función de reproducción cuando se le solicita. Para realizar la carga a memoria, se comprueba en primer lugar que la unidad de la tarjeta esté montada y disponible para realizar una operación de lectura. Posteriormente, se comprueba el tamaño del archivo, y se reserva la correspondiente memoria alineada a 32 bytes, con formato de enteros de 16 bits con signo (s16 como tipo del puntero). En último lugar, se lee el propio archivo a la zona de memoria alineada, y se cierra el flujo de bytes.</p>
<p>Un sonido dispondrá también de dos valores enteros de 8 bits sin signo, que representan el volumen de cada uno de los dos canales de audio. Estos dos valores se le pueden pasar al constructor junto con la ruta absoluta del archivo a cargar, y también se pueden modificar en tiempo de ejecución, de tal manera que, en ese sentido, la clase es bastante flexible.</p>
<p>Para escuchar un sonido, se busca la primera voz para efectos que esté libre, y se vuelca en ella la información del sonido, comenzando la reproducción. Como esta clase está pensada para pequeños efectos de sonido, no se proporciona un método de parada o pausa de la reproducción, ya que se sobreentiende que un efecto de sonido dura, a lo sumo, cinco o seis segundos.</p>
<p>Existe una función estática y pública, llamada <a class="el" href="classSonido.html#a2326861663e09bde40ce0fc2be5f08db">Sonido::inicializar()</a>, a la cual es necesario llamar antes de trabajar con la clase. Dicha función también establece que, al salir del programa, se apague el subsistema de audio de la consola.</p>
<p>Por último, un pequeño fragmento de código para ilustrar el uso de la clase:</p>
<div class="fragment"><pre class="fragment"> <span class="comment">// Cargar el sonido, previamente formateado con SoX, desde la SD. Volumen de los dos canales por defecto</span>
 <a class="code" href="classSonido.html" title="Clase que representa un efecto de sonido que se puede reproducir.">Sonido</a> s( <span class="stringliteral">&quot;/apps/wiipang/media/output.pcm&quot;</span> );
 <span class="comment">//Modificar los volúmenes de ambos canales, dando mayor volumen al canal derecho</span>
 s.setVolumenDerecho(255);
 s.setVolumenIzquierdo(100);
 <span class="comment">// Reproducir el sonido con los valores actuales de volumen</span>
 s.play();
</pre></div> </div><hr/><h2>Documentación del constructor y destructor</h2>
<a class="anchor" id="a27ca939578ce997d3e1b618389663c74"></a><!-- doxytag: member="Sonido::Sonido" ref="a27ca939578ce997d3e1b618389663c74" args="(const std::string &amp;ruta, u8 volder=255, u8 volizq=255)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Sonido::Sonido </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ruta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&#160;</td>
          <td class="paramname"><em>volder</em> = <code>255</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&#160;</td>
          <td class="paramname"><em>volizq</em> = <code>255</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>  throw (<a class="el" href="classArchivoEx.html">ArchivoEx</a>, <a class="el" href="classTarjetaEx.html">TarjetaEx</a>)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Constructor predeterminado de la clase <a class="el" href="classSonido.html" title="Clase que representa un efecto de sonido que se puede reproducir.">Sonido</a>. </p>
<dl><dt><b>Parámetros:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ruta</td><td>Ruta absoluta del fichero de sonido desde el que se cargará el efecto de sonido </td></tr>
    <tr><td class="paramname">volder</td><td>Volumen del canal derecho </td></tr>
    <tr><td class="paramname">volizq</td><td>Volumen del canal izquierdo </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Excepciones:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classArchivoEx.html" title="Clase de excepción para errores relacionados con archivos.">ArchivoEx</a></td><td>Se lanza si hay algún error al abrir el archivo al que apunta la ruta aportada </td></tr>
    <tr><td class="paramname"><a class="el" href="classTarjetaEx.html" title="Clase de excepción para errores relacionados con la tarjeta SD.">TarjetaEx</a></td><td>Se lanza si ocurre un error relacionado con la tarjeta SD </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab9cf74dc8ab701bde8457717814e9f7f"></a><!-- doxytag: member="Sonido::~Sonido" ref="ab9cf74dc8ab701bde8457717814e9f7f" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Sonido::~Sonido </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Destructor de la clase <a class="el" href="classSonido.html" title="Clase que representa un efecto de sonido que se puede reproducir.">Sonido</a>. </p>

</div>
</div>
<a class="anchor" id="aedd111f5a9ec76de8984f8f5a2191894"></a><!-- doxytag: member="Sonido::Sonido" ref="aedd111f5a9ec76de8984f8f5a2191894" args="(const Sonido &amp;m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Sonido::Sonido </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classSonido.html">Sonido</a> &amp;&#160;</td>
          <td class="paramname"><em>m</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Constructor de copia de la clase <a class="el" href="classSonido.html" title="Clase que representa un efecto de sonido que se puede reproducir.">Sonido</a>. Se encuentra en la zona protegida para no permitir la copia. </p>

</div>
</div>
<hr/><h2>Documentación de las funciones miembro</h2>
<a class="anchor" id="a2326861663e09bde40ce0fc2be5f08db"></a><!-- doxytag: member="Sonido::inicializar" ref="a2326861663e09bde40ce0fc2be5f08db" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void Sonido::inicializar </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Método de clase para inicializar el sistema de sonido de la consola. </p>

</div>
</div>
<a class="anchor" id="aa0d702b357aaebab2ab20be4cbb2602f"></a><!-- doxytag: member="Sonido::operator=" ref="aa0d702b357aaebab2ab20be4cbb2602f" args="(const Sonido &amp;m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSonido.html">Sonido</a>&amp; Sonido::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classSonido.html">Sonido</a> &amp;&#160;</td>
          <td class="paramname"><em>m</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Operador de asignación de la clase <a class="el" href="classSonido.html" title="Clase que representa un efecto de sonido que se puede reproducir.">Sonido</a>. Se encuentra en la zona protegida para no permitir la asignación. </p>

</div>
</div>
<a class="anchor" id="a43de62e384345dcdcd3e7c989806cccf"></a><!-- doxytag: member="Sonido::play" ref="a43de62e384345dcdcd3e7c989806cccf" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Sonido::play </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Método que reproduce un sonido una sola vez, con el volumen prefijado para cada canal. Si el sonido pudiera reproducirse correctamente, se devuelve un valor True, en caso contrario, el método devuelve un valor False. </p>
<dl class="return"><dt><b>Devuelve:</b></dt><dd>Se devuelve verdadero si el sonido se reproduce correctamente, en caso contrario, falso. </dd></dl>

</div>
</div>
<a class="anchor" id="a9a9f095bac28bf072492e8706c290746"></a><!-- doxytag: member="Sonido::setVolumenDerecho" ref="a9a9f095bac28bf072492e8706c290746" args="(u8 volumen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sonido::setVolumenDerecho </td>
          <td>(</td>
          <td class="paramtype">u8&#160;</td>
          <td class="paramname"><em>volumen</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Función modificadora del volumen del canal derecho del sonido. </p>
<dl><dt><b>Parámetros:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">volumen</td><td>Nuevo valor para el volumen del canal derecho (entre 0 y 255). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a49658fea59993ab7b5e474b5cb74ced1"></a><!-- doxytag: member="Sonido::setVolumenIzquierdo" ref="a49658fea59993ab7b5e474b5cb74ced1" args="(u8 volumen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Sonido::setVolumenIzquierdo </td>
          <td>(</td>
          <td class="paramtype">u8&#160;</td>
          <td class="paramname"><em>volumen</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Función modificadora del volumen del canal izquierdo del sonido. </p>
<dl><dt><b>Parámetros:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">volumen</td><td>Nuevo valor para el volumen del canal izquierdo (entre 0 y 255). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>La documentación para esta clase fue generada a partir del siguiente fichero:<ul>
<li>/home/rabbit/Escritorio/libwiiesp/include/<a class="el" href="sonido_8h_source.html">sonido.h</a></li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>Todo</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Clases</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Funciones</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>&apos;typedefs&apos;</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumeraciones</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generado el Martes, 19 de Julio de 2011 20:45:53 para libWiiEsp por&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
