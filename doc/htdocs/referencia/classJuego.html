<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>libWiiEsp: Referencia de la Clase Juego</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generado por Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Buscar');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libWiiEsp&#160;<span id="projectnumber">0.9.2</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Página&#160;principal</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Clases</span></a></li>
      <li><a href="files.html"><span>Archivos</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Buscar" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Lista&#160;de&#160;clases</span></a></li>
      <li><a href="classes.html"><span>Índice&#160;de&#160;clases</span></a></li>
      <li><a href="inherits.html"><span>Jerarquía&#160;de&#160;la&#160;clase</span></a></li>
      <li><a href="functions.html"><span>Miembros&#160;de&#160;las&#160;clases</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Métodos públicos</a> &#124;
<a href="#pro-types">Tipos protegidos</a> &#124;
<a href="#pro-methods">Métodos protegidos</a> &#124;
<a href="#pro-attribs">Atributos protegidos</a>  </div>
  <div class="headertitle">
<h1>Referencia de la Clase Juego</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="Juego" -->
<p>Clase que proporciona una base para definir el objeto principal del programa de manera fácil.  
<a href="#_details">Más...</a></p>

<p><code>#include &lt;<a class="el" href="juego_8h_source.html">juego.h</a>&gt;</code></p>

<p><a href="classJuego-members.html">Lista de todos los miembros.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Métodos públicos</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJuego.html#a85dab9804783c1a74d09bd5aa069a2cd">Juego</a> (const std::string &amp;ruta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJuego.html#abe9f1c9897d9831000008bbdb571d5e5">~Juego</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJuego.html#a8678b8ec17d2725309e608c4fd185a2e">run</a> (void)</td></tr>
<tr><td colspan="2"><h2><a name="pro-types"></a>
Tipos protegidos</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; std::string, <br class="typebreak"/>
<a class="el" href="classMando.html">Mando</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJuego.html#a42c506182570942a656a11bb333bfb54">Controles</a></td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Métodos protegidos</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJuego.html#afabf495ff20d0ec4ad36858e81af2003">cargar</a> (void)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJuego.html#a7f489e7bcf12af56c040d763c9f7c206">frame</a> (void)=0</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Atributos protegidos</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classJuego.html#a42c506182570942a656a11bb333bfb54">Controles</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJuego.html#afbd0c608f29a302de019f1489136a6d0">_mandos</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">u8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJuego.html#ad2286a3849f6f0fb820692d9f7f82383">_fps</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Descripción detallada</h2>
<div class="textblock"><p>Clase que proporciona una base para definir el objeto principal del programa de manera fácil. </p>
<dl class="author"><dt><b>Autor:</b></dt><dd>Ezequiel Vázquez de la Calle </dd></dl>
<dl class="version"><dt><b>Versión:</b></dt><dd>0.9.2</dd></dl>
<p>Esta clase abstracta proporciona una plantilla sobre la que construir el objeto principal de toda aplicación desarrollada con LibWiiEsp. Consiste en dos apartados bien diferenciados, que son la inicialización de todos los subsistemas de la consola y de la biblioteca (esto se realiza desde el constructor), y la ejecución del bucle principal de la aplicación. Como clase abstracta que es, no se puede instanciar directamente, si no que hay que crear a partir de ella una clase derivada en la que se definan los métodos que el programador considere oportunos para gestionar el programa.</p>
<p>Además de la inicialización de la consola y el control del bucle principal del programa, esta clase también se encarga de gestionar la entrada de hasta cuatro mandos en la consola. Para ello, dispone de un diccionario (de tipo std::map) en el que cada jugador, que está identificado por un código único (de tipo std::string), tiene asociado un mando concreto de la consola. Para acceder al mando de un jugador, basta con buscar en el diccionario mediante el código identificativo del éste.</p>
<p>El constructor de la clase recibe como parámetro un archivo XML con un formato concreto, en el que se deben especificar las opciones de configuración para el programa, como son el nivel de logging deseado y la ruta completa del archivo de log que se generará en el caso de estar el sistema de log activado, el color considerado transparente y que no se dibujará en la pantalla (en formato 0xRRGGBBAA, ver documentación de la clase <a class="el" href="classScreen.html" title="Clase que gestiona los gráficos en la Nintendo Wii.">Screen</a> para más información), el número de fotogramas por segundo (FPS) que se quiere que tenga el videojuego, la ruta absoluta hasta el archivo XML donde se especifican los recursos multimedia que deben ser cargados en la galería de medias (más información en la descripción de la clase <a class="el" href="classGaleria.html" title="Clase que gestiona los recursos media del sistema, y facilita su carga en memoria y el acceso a ellos...">Galeria</a>), la ruta absoluta hasta el archivo XML donde se especifican las etiquetas de texto del sistema de idiomas y el nombre del idioma por defecto (más detalles en la descripción de la clase <a class="el" href="classLang.html" title="Soporte para múltiples idiomas en la misma aplicación, basado en un archivo de idiomas en formato XML...">Lang</a>), y por último, la configuración de jugadores, consistente en cuatro atributos de tipo cadena de caracteres en los que se deben especificar los códigos identificadores para cada uno de los jugadores.</p>
<p>A continuación, se muestra un ejemplo del archivo de configuración esperado:</p>
<div class="fragment"><pre class="fragment"> &lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span>?&gt;
 &lt;conf&gt;
   &lt;log valor=<span class="stringliteral">&quot;/apps/wiipang/info.log&quot;</span> nivel=<span class="stringliteral">&quot;3&quot;</span> /&gt;
   &lt;alpha valor=<span class="stringliteral">&quot;0xFF00FFFF&quot;</span> /&gt;
   &lt;fps valor=<span class="stringliteral">&quot;25&quot;</span> /&gt;
   &lt;galeria valor=<span class="stringliteral">&quot;/apps/wiipang/xml/galeria.xml&quot;</span> /&gt;
   &lt;lang valor=<span class="stringliteral">&quot;/apps/wiipang/xml/lang.xml&quot;</span> defecto=<span class="stringliteral">&quot;english&quot;</span> /&gt;
   &lt;jugadores pj1=<span class="stringliteral">&quot;pj1&quot;</span> pj2=<span class="stringliteral">&quot;pj2&quot;</span> pj3=<span class="stringliteral">&quot;&quot;</span> pj4=<span class="stringliteral">&quot;&quot;</span> /&gt;
 &lt;/conf&gt;
</pre></div><p>El constructor de la clase <a class="el" href="classJuego.html" title="Clase que proporciona una base para definir el objeto principal del programa de manera fácil...">Juego</a>, que debe ser llamado en el constructor de la correspondiente clase derivada, se encarga en primer lugar de montar la primera partición de la tarjeta SD (debe ser una partición con sistema de ficheros FAT), cargar el árbol XML del archivo de configuración en memoria mediante la clase <a class="el" href="classParser.html" title="Clase que facilita la lectura de información desde archivos XML situados en la tarjeta SD de la conso...">Parser</a>, e inicializar el sistema de logging según se haya especificado en el archivo de configuración. Si en alguna de estas operaciones se produjera un error, se saldría del programa mediante una llamada a la función exit().</p>
<p>A partir de ese momento, el constructor inicializará los sistemas de vídeo (clase <a class="el" href="classScreen.html" title="Clase que gestiona los gráficos en la Nintendo Wii.">Screen</a>), controles (clase <a class="el" href="classMando.html" title="Clase que permite leer información desde un Wii Remote.">Mando</a>), sonido (clase <a class="el" href="classSonido.html" title="Clase que representa un efecto de sonido que se puede reproducir.">Sonido</a>) y la biblioteca FreeType de gestión de fuentes (clase <a class="el" href="classFuente.html" title="Clase que permite gestionar una fuente de texto a través de FreeType2.">Fuente</a>). A continuación, establece el color transparente del sistema y el número de FPS, después de lo cual, leerá la configuración de los jugadores, y creará una instancia de <a class="el" href="classMando.html" title="Clase que permite leer información desde un Wii Remote.">Mando</a> para cada jugador que, en el archivo de configuración, no tenga una cadena vacía como identificador. Posteriormente, guarda cada mando asociado al código del jugador correspondiente en el diccionario de Controles.</p>
<p>Por último, se cargan todos los recursos media en la <a class="el" href="classGaleria.html" title="Clase que gestiona los recursos media del sistema, y facilita su carga en memoria y el acceso a ellos...">Galeria</a>, y las etiquetas de texto para los idiomas del sistema en la clase <a class="el" href="classLang.html" title="Soporte para múltiples idiomas en la misma aplicación, basado en un archivo de idiomas en formato XML...">Lang</a>.</p>
<p>Después de haber inicializado la consola partiendo del archivo de configuración, el método virtual <a class="el" href="classJuego.html#a8678b8ec17d2725309e608c4fd185a2e">run()</a> proporciona una implementación básica del bucle principal del programa, en la que se controlan las posibles excepciones que puedan lanzarse (las cuales captura y almacena su mensaje en el archivo de log), se mantiene constante la tasa de fotogramas por segundo, y se actualizan todos los mandos conectados a la consola y se gestiona correctamente la actualización de los gráficos a cada fotograma. Junto a este método <a class="el" href="classJuego.html#a8678b8ec17d2725309e608c4fd185a2e">run()</a>, también se proporciona un método virtual puro, llamado <a class="el" href="classJuego.html#afabf495ff20d0ec4ad36858e81af2003">cargar()</a>, y que se ejecuta antes de entrar en el bucle principal. Este método permite realizar las operaciones que se estimen necesarias antes de comenzar la ejecución del bucle, en el caso de que fueran necesarias (en caso contrario, bastaría con definir el método como una función vacía a la hora de derivar la clase <a class="el" href="classJuego.html" title="Clase que proporciona una base para definir el objeto principal del programa de manera fácil...">Juego</a>).</p>
<p>Igualmente, al ser el método <a class="el" href="classJuego.html#a8678b8ec17d2725309e608c4fd185a2e">run()</a> virtual, si el programador necesita otro tipo de gestión para el bucle principal de la aplicación, basta con que lo redefina en la clase derivada; a pesar de ello, tendrá disponible un sencillo ejemplo de control del bucle de la aplicación en la definición del método en la clase <a class="el" href="classJuego.html" title="Clase que proporciona una base para definir el objeto principal del programa de manera fácil...">Juego</a>.</p>
<p>Por último, especificar un detalle, y es que el destructor de la clase <a class="el" href="classJuego.html" title="Clase que proporciona una base para definir el objeto principal del programa de manera fácil...">Juego</a> se encarga de liberar la memoria ocupada por los objetos de la clase <a class="el" href="classMando.html" title="Clase que permite leer información desde un Wii Remote.">Mando</a>, de tal manera que no hay que preocuparse por ello. </p>
</div><hr/><h2>Documentación de los 'Typedef' miembros de la clase</h2>
<a class="anchor" id="a42c506182570942a656a11bb333bfb54"></a><!-- doxytag: member="Juego::Controles" ref="a42c506182570942a656a11bb333bfb54" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt;std::string, <a class="el" href="classMando.html">Mando</a>*&gt; <a class="el" href="classJuego.html#a42c506182570942a656a11bb333bfb54">Juego::Controles</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Estructura para almacenar los mandos conectados a la consola, asociado cada uno al código de identificación del jugador al que corresponde el mando. Si en el XML de configuración aparece pj1=jugador1", entonces se creará un mando para el primer jugador con el código "jugador1".
 Si en el XML, por ejemplo, aparece pj4="", entonces no se crea mando para el cuarto jugador. </p>

</div>
</div>
<hr/><h2>Documentación del constructor y destructor</h2>
<a class="anchor" id="a85dab9804783c1a74d09bd5aa069a2cd"></a><!-- doxytag: member="Juego::Juego" ref="a85dab9804783c1a74d09bd5aa069a2cd" args="(const std::string &amp;ruta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Juego::Juego </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ruta</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Constructor de la clase abstracta <a class="el" href="classJuego.html" title="Clase que proporciona una base para definir el objeto principal del programa de manera fácil...">Juego</a>. Carga un archivo XML con la configuración que se quiere aplicar al programa. El archivo debe estar situado en la tarjeta SD. Después de leer el archivo XML, inicializa la consola Nintendo Wii según los parámetros establecidos en la configuración. </p>
<dl><dt><b>Parámetros:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ruta</td><td>Ruta absoluta hasta el archivo de configuración. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="abe9f1c9897d9831000008bbdb571d5e5"></a><!-- doxytag: member="Juego::~Juego" ref="abe9f1c9897d9831000008bbdb571d5e5" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual Juego::~Juego </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Destructor virtual de la clase abstracta <a class="el" href="classJuego.html" title="Clase que proporciona una base para definir el objeto principal del programa de manera fácil...">Juego</a>. Llama a la función exit(0) después de liberar la memoria ocupada. Esto es obligado para que se disparen las funciones de la pila atexit(), y que de no ser contemplado, produciría un error en la consola. </p>

</div>
</div>
<hr/><h2>Documentación de las funciones miembro</h2>
<a class="anchor" id="afabf495ff20d0ec4ad36858e81af2003"></a><!-- doxytag: member="Juego::cargar" ref="afabf495ff20d0ec4ad36858e81af2003" args="(void)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void Juego::cargar </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected, pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Método virtual puro en el que se debe implementar toda la lógica que se necesite ejecutar antes de que comience el bucle principal de la aplicación. </p>

</div>
</div>
<a class="anchor" id="a7f489e7bcf12af56c040d763c9f7c206"></a><!-- doxytag: member="Juego::frame" ref="a7f489e7bcf12af56c040d763c9f7c206" args="(void)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool Juego::frame </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected, pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Método virtual puro en el que se debe implementar toda la lógica que se necesite ejecutar durante el bucle principal de la aplicación. </p>

</div>
</div>
<a class="anchor" id="a8678b8ec17d2725309e608c4fd185a2e"></a><!-- doxytag: member="Juego::run" ref="a8678b8ec17d2725309e608c4fd185a2e" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void Juego::run </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Método que contiene el bucle principal del juego. Establece el control de tiempo para mantener los FPS constantes (según el valor leído desde el archivo de configuración), y se encarga de actualizar los mandos conectados a la consola a cada iteración. Toda la lógica del programa que deba ir en este bucle principal se debe implementar en el método virtual <a class="el" href="classJuego.html#a7f489e7bcf12af56c040d763c9f7c206">frame()</a>. </p>

</div>
</div>
<hr/><h2>Documentación de los datos miembro</h2>
<a class="anchor" id="ad2286a3849f6f0fb820692d9f7f82383"></a><!-- doxytag: member="Juego::_fps" ref="ad2286a3849f6f0fb820692d9f7f82383" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u8 <a class="el" href="classJuego.html#ad2286a3849f6f0fb820692d9f7f82383">Juego::_fps</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Tasa de fotogramas por segundo que tendrá la aplicación. </p>

</div>
</div>
<a class="anchor" id="afbd0c608f29a302de019f1489136a6d0"></a><!-- doxytag: member="Juego::_mandos" ref="afbd0c608f29a302de019f1489136a6d0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classJuego.html#a42c506182570942a656a11bb333bfb54">Controles</a> <a class="el" href="classJuego.html#afbd0c608f29a302de019f1489136a6d0">Juego::_mandos</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Estructura que almacena los mandos conectados a la consola. </p>

</div>
</div>
<hr/>La documentación para esta clase fue generada a partir del siguiente fichero:<ul>
<li>/home/rabbit/Escritorio/libwiiesp/include/<a class="el" href="juego_8h_source.html">juego.h</a></li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>Todo</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Clases</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Funciones</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>&apos;typedefs&apos;</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumeraciones</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generado el Martes, 19 de Julio de 2011 20:45:52 para libWiiEsp por&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
