<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>libWiiEsp: Referencia de la Clase Musica</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generado por Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Buscar');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libWiiEsp&#160;<span id="projectnumber">0.9.2</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Página&#160;principal</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Clases</span></a></li>
      <li><a href="files.html"><span>Archivos</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Buscar" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Lista&#160;de&#160;clases</span></a></li>
      <li><a href="classes.html"><span>Índice&#160;de&#160;clases</span></a></li>
      <li><a href="inherits.html"><span>Jerarquía&#160;de&#160;la&#160;clase</span></a></li>
      <li><a href="functions.html"><span>Miembros&#160;de&#160;las&#160;clases</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Métodos públicos</a> &#124;
<a href="#pro-methods">Métodos protegidos</a>  </div>
  <div class="headertitle">
<h1>Referencia de la Clase Musica</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="Musica" -->
<p>Clase que representa una pista de música que puede ser reproducida en la consola Nintendo Wii.  
<a href="#_details">Más...</a></p>

<p><code>#include &lt;<a class="el" href="musica_8h_source.html">musica.h</a>&gt;</code></p>

<p><a href="classMusica-members.html">Lista de todos los miembros.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Métodos públicos</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMusica.html#ade8091d731fd51d786eb0427a8c2cb8c">Musica</a> (const std::string &amp;ruta, u8 volumen=255)  throw (ArchivoEx, TarjetaEx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMusica.html#a28806ca0fe56cbd6976b0c8d4b2903d9">~Musica</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMusica.html#ad0789dfaa8f115fcd146d79ee968d116">play</a> (void) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMusica.html#a2cec41cc35fc619fd4f185eda0f3c517">stop</a> (void) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMusica.html#a92d724bcb781331898fddd78551a9d7e">loop</a> (void) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMusica.html#afd9cee03e5db303bd7375b0962652005">reproduciendo</a> (void) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMusica.html#a874684b5e06be08056e6c43fdb1120cd">setVolumen</a> (u8 volumen)</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Métodos protegidos</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMusica.html#ab241d7df40d43d1e160b52d545d307fb">Musica</a> (const <a class="el" href="classMusica.html">Musica</a> &amp;m)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMusica.html">Musica</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMusica.html#a2b248c35c2afeb3538e21a73d6e60d4d">operator=</a> (const <a class="el" href="classMusica.html">Musica</a> &amp;m)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Descripción detallada</h2>
<div class="textblock"><p>Clase que representa una pista de música que puede ser reproducida en la consola Nintendo Wii. </p>
<dl class="author"><dt><b>Autor:</b></dt><dd>Ezequiel Vázquez de la Calle </dd></dl>
<dl class="version"><dt><b>Versión:</b></dt><dd>0.9.2</dd></dl>
<p>Esta clase, como todas las clases que representan recursos media, proporciona una abstracción de las funciones y estructuras de datos necesarias para utilizar dichos recursos, en este caso, la clase <a class="el" href="classMusica.html" title="Clase que representa una pista de música que puede ser reproducida en la consola Nintendo Wii...">Musica</a> permite cargar y reproducir archivos de audio en formato MP3, y está pensada para las pistas de música. La biblioteca de bajo nivel que utiliza esta clase para poder utilizar dichas pistas es un port de libmad.</p>
<p>Cada instancia de la clase representa una pista de música, independiente de todas las demás, y preparada para ser reproducida en cualquier punto del programa. Se crea partir de un archivo de audio en formato MP3, cargando éste desde la tarjeta SD de la consola. En principio, cualquier formato (frecuencia, bitrate) de MP3 puede ser utilizado con esta clase, pero se recomienda reducir el bitrate a 128 kbps y mantener la frecuencia a 44100 Hz, así como no almacenar demasiadas pistas a la vez en memoria, ya que la memoria de la que dispone la consola es limitada (64 megas), y cada pista se carga tal cual mediante un flujo de entrada desde ficheros (con lo que el consumo de espacio es bastante alto).</p>
<p>En la descripción de la clase <a class="el" href="classSonido.html" title="Clase que representa un efecto de sonido que se puede reproducir.">Sonido</a> puede obtenerse más información sobre cómo trabaja el subsistema de sonido de la consola. A partir de ahí, se sabe que existe una voz (un flujo de datos que se pasan directamente al procesador de sonido, el DSP) reservada exclusivamente para pistas de música. La implementación de libmad sobre la que se trabaja con la clase <a class="el" href="classMusica.html" title="Clase que representa una pista de música que puede ser reproducida en la consola Nintendo Wii...">Musica</a> hace uso de dicha voz, de tal manera que sólo se puede reproducir una única pista de música a la vez. Por otro lado, es seguro que no se interferirá con la reproducción de un efecto de sonido encapsulado en una instancia de la clase <a class="el" href="classSonido.html" title="Clase que representa un efecto de sonido que se puede reproducir.">Sonido</a>. Además, al ser un port, no hay que preocuparse de detalles como el Endian al leer, ya que las funciones de libmad están preparadas para encargarse de dichos detalles.</p>
<p>Al reproducir una pista, por defecto sólo se reproduce una vez. De hecho, libmad no da soporte a la reproducción ininterrumpida como tal. Si se quiere mantener una pista en reproducción infinita (hasta que se detenga explícitamente o se salga del programa) hay que indicarlo al utilizar la función <a class="el" href="classMusica.html#ad0789dfaa8f115fcd146d79ee968d116">play()</a> mediante su parámetro booleano (hay que especificarlo en cada reproducción; por defecto, se toma el valor false), y llamar a <a class="el" href="classMusica.html#a92d724bcb781331898fddd78551a9d7e">loop()</a> en cada iteración del bucle principal (este método se encarga de iniciar la reproducción de nuevo cuando se acabe la pista en reproducción, pero sólo lo hace si se indicó reproducción continua al iniciarla).</p>
<p>Funcionamiento interno</p>
<p>Esta clase consiste únicamente en un flujo de bytes (la propia pista de música), atributos simples (tamaño, indicador de reproducción infinita y volumen) y la interfaz de la libmad.</p>
<p>A la hora de crear una instancia de la clase, lo primero que se hace es comprobar que la tarjeta SD está montada y lista para ser utilizada. En caso de no ser así, se lanza una excepción indicando el error. Posteriormente, se abre el archivo que se recibe como parámetro mediante la ruta absoluta de éste en la tarjeta. Hay otro parámetro opcional, un entero de 8 bits sin signo (u8), que representa el volumen de la pista de audio (siendo 0 el volumen mínimo, y 255 el máximo), y que se puede modificar en tiempo de ejecución mediante el método modificador <a class="el" href="classMusica.html#a874684b5e06be08056e6c43fdb1120cd">setVolumen()</a>. El archivo MP3 se abre mediante un flujo de entrada de bytes ifstream, y se lee en bloque sobre una zona de memoria reservada previamente, de tipo puntero entero de 16 bits con signo (s16), alineada a 32 bytes, y convenientemente ajustada a un tamaño múltiplo de 32 bytes también. Si todo va bien, se cierra el flujo de entrada, y queda lista la pista de sonido para ser reproducida.</p>
<p>Para iniciar la reproducción de la pista, basta con llamar al método <a class="el" href="classMusica.html#ad0789dfaa8f115fcd146d79ee968d116">play()</a> de la instancia, indicando si se quiere reproducir una vez, o de forma ininterrumpida (tal y como se ha explicado previamente). Este método se encarga de parar cualquier reproducción que haya en curso, establecer el volumen de la nueva reproducción y enviar el flujo de bytes que compone la pista de audio a la voz reservada para música, realizándose estas dos últimas tareas a través de la interfaz que proporciona libmad.</p>
<p>En cualquier momento se puede detener la reproducción de una pista de música llamando al método <a class="el" href="classMusica.html#a2cec41cc35fc619fd4f185eda0f3c517">stop()</a>, y también conocer si se está reproduciendo una pista de música o no mediante el método <a class="el" href="classMusica.html#afd9cee03e5db303bd7375b0962652005">reproduciendo()</a>. Estas dos funciones también trabajan directamente con la interfaz de libmad.</p>
<p>Por último, el destructor se encarga de detener la reproducción y de liberar la memoria ocupada por la pista de música.</p>
<p>Hay que mencionar que esta clase tiene una "limitación" importante, y es que si se está reproduciendo una pista de audio A, y se realiza una llamada al método <a class="el" href="classMusica.html#a2cec41cc35fc619fd4f185eda0f3c517">stop()</a> de una instancia B, la reproducción de A se detendría. Este comportamiento es intencionado, ya que interesa que, si se está reproduciendo una pista al iniciar la reproducción de otra distinta, la primera se detenga para poder iniciar la nueva.</p>
<p>Ejemplo de uso</p>
<div class="fragment"><pre class="fragment">    <span class="comment">// Crear una instancia a partir de un archivo MP3</span>
    <a class="code" href="classMusica.html" title="Clase que representa una pista de música que puede ser reproducida en la consola Nintendo Wii...">Musica</a> rock( <span class="stringliteral">&quot;/apps/wiipang/media/rock.mp3&quot;</span>, 255 );
    <span class="comment">// Iniciar la reproducción</span>
    rock.play();
    <span class="comment">// Detener la reproducción, en el caso de que se esté reproduciendo</span>
    <span class="keywordflow">if</span> ( rock.reproduciendo() )
        rock.stop();
    <span class="comment">// Iniciar una reproducción infinita</span>
    rock.play( <span class="keyword">true</span> );
    <span class="comment">// Mantener la reproducción infinita en cada iteración del bucle principal</span>
    <span class="keywordflow">while</span>( 1 ) {
        <span class="comment">// ...</span>
        rock.loop();
        <span class="comment">// ...</span>
    }
</pre></div> </div><hr/><h2>Documentación del constructor y destructor</h2>
<a class="anchor" id="ade8091d731fd51d786eb0427a8c2cb8c"></a><!-- doxytag: member="Musica::Musica" ref="ade8091d731fd51d786eb0427a8c2cb8c" args="(const std::string &amp;ruta, u8 volumen=255)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Musica::Musica </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ruta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8&#160;</td>
          <td class="paramname"><em>volumen</em> = <code>255</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>  throw (<a class="el" href="classArchivoEx.html">ArchivoEx</a>, <a class="el" href="classTarjetaEx.html">TarjetaEx</a>)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Constructor predeterminado de la clase <a class="el" href="classMusica.html" title="Clase que representa una pista de música que puede ser reproducida en la consola Nintendo Wii...">Musica</a>. </p>
<dl><dt><b>Parámetros:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ruta</td><td>Ruta absoluta del fichero MP3 desde el que se cargará la pista de música </td></tr>
    <tr><td class="paramname">volumen</td><td>Volumen de la pista de sonido </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Excepciones:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classArchivoEx.html" title="Clase de excepción para errores relacionados con archivos.">ArchivoEx</a></td><td>Se lanza si hay algún error al abrir el archivo al que apunta la ruta aportada </td></tr>
    <tr><td class="paramname"><a class="el" href="classTarjetaEx.html" title="Clase de excepción para errores relacionados con la tarjeta SD.">TarjetaEx</a></td><td>Se lanza si ocurre un error relacionado con la tarjeta SD </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a28806ca0fe56cbd6976b0c8d4b2903d9"></a><!-- doxytag: member="Musica::~Musica" ref="a28806ca0fe56cbd6976b0c8d4b2903d9" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Musica::~Musica </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Destructor de la clase <a class="el" href="classMusica.html" title="Clase que representa una pista de música que puede ser reproducida en la consola Nintendo Wii...">Musica</a>. </p>

</div>
</div>
<a class="anchor" id="ab241d7df40d43d1e160b52d545d307fb"></a><!-- doxytag: member="Musica::Musica" ref="ab241d7df40d43d1e160b52d545d307fb" args="(const Musica &amp;m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Musica::Musica </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMusica.html">Musica</a> &amp;&#160;</td>
          <td class="paramname"><em>m</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Constructor de copia de la clase <a class="el" href="classMusica.html" title="Clase que representa una pista de música que puede ser reproducida en la consola Nintendo Wii...">Musica</a>. Se encuentra en la zona protegida para no permitir la copia. </p>

</div>
</div>
<hr/><h2>Documentación de las funciones miembro</h2>
<a class="anchor" id="a92d724bcb781331898fddd78551a9d7e"></a><!-- doxytag: member="Musica::loop" ref="a92d724bcb781331898fddd78551a9d7e" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Musica::loop </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Método que mantiene la reproducción infinita de la pista de música. Se debe llamar dentro del bucle principal de la aplicación para mantener la pista reproduciéndose de forma contínua. Si no se quiere reproducir infinitamente, basta con no llamar a este método. </p>

</div>
</div>
<a class="anchor" id="a2b248c35c2afeb3538e21a73d6e60d4d"></a><!-- doxytag: member="Musica::operator=" ref="a2b248c35c2afeb3538e21a73d6e60d4d" args="(const Musica &amp;m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMusica.html">Musica</a>&amp; Musica::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMusica.html">Musica</a> &amp;&#160;</td>
          <td class="paramname"><em>m</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Operador de asignación de la clase <a class="el" href="classMusica.html" title="Clase que representa una pista de música que puede ser reproducida en la consola Nintendo Wii...">Musica</a>. Se encuentra en la zona protegida para no permitir la asignación. </p>

</div>
</div>
<a class="anchor" id="ad0789dfaa8f115fcd146d79ee968d116"></a><!-- doxytag: member="Musica::play" ref="ad0789dfaa8f115fcd146d79ee968d116" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Musica::play </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Método que reproduce una pista de música, con el volumen prefijado. </p>

</div>
</div>
<a class="anchor" id="afd9cee03e5db303bd7375b0962652005"></a><!-- doxytag: member="Musica::reproduciendo" ref="afd9cee03e5db303bd7375b0962652005" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Musica::reproduciendo </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Método que indica si se está reproduciendo la pista actualmente. </p>
<dl class="return"><dt><b>Devuelve:</b></dt><dd>Verdadero si se está reproduciedo la pista, o falso en caso contrario. </dd></dl>

</div>
</div>
<a class="anchor" id="a874684b5e06be08056e6c43fdb1120cd"></a><!-- doxytag: member="Musica::setVolumen" ref="a874684b5e06be08056e6c43fdb1120cd" args="(u8 volumen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Musica::setVolumen </td>
          <td>(</td>
          <td class="paramtype">u8&#160;</td>
          <td class="paramname"><em>volumen</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Función modificadora del volumen de la pista de música. </p>
<dl><dt><b>Parámetros:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">volumen</td><td>Nuevo valor para el volumen de la pista de música (entre 0 y 255) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2cec41cc35fc619fd4f185eda0f3c517"></a><!-- doxytag: member="Musica::stop" ref="a2cec41cc35fc619fd4f185eda0f3c517" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Musica::stop </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Método que detiene la reproducción de una pista de música. </p>

</div>
</div>
<hr/>La documentación para esta clase fue generada a partir del siguiente fichero:<ul>
<li>/home/rabbit/Escritorio/libwiiesp/include/<a class="el" href="musica_8h_source.html">musica.h</a></li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>Todo</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Clases</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Funciones</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>&apos;typedefs&apos;</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumeraciones</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generado el Martes, 19 de Julio de 2011 20:45:52 para libWiiEsp por&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
